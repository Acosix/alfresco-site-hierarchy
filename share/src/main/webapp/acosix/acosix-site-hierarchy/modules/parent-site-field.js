/* jshint -W003 */
if (typeof Acosix === 'undefined' || !Acosix)
{
    var Acosix = {};
}
/* jshint +W003 */

(function()
{
    var Dom = YAHOO.util.Dom;

    Acosix.customisation = Acosix.customisation || {};
    Acosix.customisation.SiteHierarchy = Acosix.customisation.SiteHierarchy || {};

    Acosix.customisation.SiteHierarchy.parentSiteFieldInitialiser = function Acosix_parentSiteFieldInitialiser(currentValue)
    {
        // usually, messages are applied using inline code generated by FTL template
        // manually copy over messages of module component which should also contain necessary fragments for ObjectFinder
        Alfresco.util.copyMessages(this.name, 'Alfresco.ObjectFinder');
        Alfresco.util.copyMessages(this.name, 'Alfresco.ObjectRenderer');

        this.widgets.parentSite = new Alfresco.ObjectFinder(this.id + '-parentSite-cntrl', this.id + '-parentSite');
        this.widgets.parentSite.setOptions({
            field : 'parentSite',
            compactMode : false,
            mandatory : false,
            currentValue : currentValue || '',
            selectActionLabel : Alfresco.util.message('button.select'),
            itemFamily : 'node',
            itemType : 'st:site',
            parentNodeRef : 'alfresco://sites/home',
            multipleSelectMode : false,
            displayMode : 'items'
        });

        // need to call this explicitly as both default load events (page load and dialog template load) have already been passed and
        // object-finder dependencies may still be in the queue if they weren't already available
        Alfresco.util.YUILoaderHelper.loadComponents(false);

        Dom.removeClass(this.id + '-acosix-site-hierarchy', 'hidden');
    };
}());
